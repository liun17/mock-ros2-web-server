<!DOCTYPE html>
<html>

<style>
  h2 {
    color: #051B66;
    font-size: 40px;
    text-align: center;
    font-weight: bold;
    font-family:'Franklin Gothic Medium', 'Arial Narrow', Arial, sans-serif;
  }
  body {
    color: #16328F;
    font-size: 30px;
    text-align: center;
    background-color: #cccccc;
    font-weight: bold;
  }
  .result {
    color: #FF7B00;
    font-size: 55px;
    text-align: center;
    background-color: #cccccc;
    font-weight: bold;
  }
  .button {
      background-color: #4CAF50;
      border: none;
      color: white;
      padding: 15px 32px;
      text-align: center;
      text-decoration: none;
      font-weight: bold;
      display: inline-block;
      font-size: 16px;
      margin: 4px 2px;
      cursor: pointer;
  }
</style> 



<h2>Tan De Mo</h2>
  <body>
    <div>
      <p id="href"></p>
    </div>
      <img src="static/cgh_logo.jpg" id="image" hspace="80" style="width:304px;height:228px;">
    <div>
      <br>
      <button id='endcall_btn' class="button" onclick="EndCall()" ></button>
    </div>


    <script>
      
      let is_calling = false;

      let url = document.createElement("a");
      url.href = window.location.href;
      
      var ws = new WebSocket('ws://' + url.hostname + ':8888/ws');

      // connect ws port
      ws.onopen = function () {
          console.log('websocket is connected ...')
          ws.send('connected')
      }

      // When Receive web socket msg
      ws.onmessage = function (ev) {
        let status = Number(ev.data)
        console.log(status);

        if ( (status == 1) && (is_calling == false)  ){
          console.log("---- Start Call ------");
          document.getElementById("image").src = "static/patient_call_live.png"
          document.getElementById("endcall_btn").innerHTML= "End Call";
          is_calling = true
        }
      }

      // Button endcall function
      function EndCall(){
        console.log("End Call");
        ws.send(0);
        document.getElementById("image").src = "static/cgh_logo.jpg"
        document.getElementById("endcall_btn").innerHTML= "";
        status = 0;
        is_calling = false;
      }

    </script>

  </body>
</html>